FROM centos:7
EXPOSE 4567
WORKDIR /tmp/meme
RUN yum -y install ruby ruby-devel.x86_64 gcc gcc-c++ make git && \
 gem install bundle json execjs therubyracer && \
 git clone https://github.com/voxmedia/meme.git /tmp/meme && \
 /usr/local/bin/bundle install && \
 sed -i '1s/^/require "therubyracer"\n/' /usr/local/share/gems/gems/execjs-2.2.0/lib/execjs/runtimes.rb && \
 yum -y remove gcc gcc-c++ libstdc++-devel.x86_64 0:4.8.3-9.el7 glibc-devel-2.17-78.el7.x86_64 libmpc-1.0.1-3.el7.x86_64 mpfr-3.1.1-4.el7.x86_64 glibc-headers-2.17-78.el7.x86_64 kernel-headers-3.10.0-229.20.1.el7.x86_64 cpp-4.8.3-9.el7.x86_64 gcc-4.8.3-9.el7.x86_64 ruby-devel-2.0.0.598-25.el7_1.x86_64 libgnome-keyring-3.8.0-3.el7.x86_64 perl-Git-1.8.3.1-4.el7.noarch git-1.8.3.1-4.el7.x86_64 perl-TermReadKey-2.30-20.el7.x86_64 perl-Error-0.17020-2.el7.noarch cpp.x86_64 0:4.8.3-9.el7 fipscheck.x86_64 0:1.4.1-5.el7 fipscheck-lib.x86_64 0:1.4.1-5.el7 glibc-devel.x86_64 0:2.17-78.el7 glibc-headers.x86_64 0:2.17-78.el7 kernel-headers.x86_64 0:3.10.0-229.20.1.el7 libedit.x86_64 0:3.0-12.20121213cvs.el7 libgnome-keyring.x86_64 0:3.8.0-3.el7 libmpc.x86_64 0:1.0.1-3.el7 libstdc++-devel.x86_64 0:4.8.3-9.el7 mpfr.x86_64 0:3.1.1-4.el7 openssh.x86_64 0:6.6.1p1-12.el7_1 openssh-clients.x86_64 0:6.6.1p1-12.el7_1 perl.x86_64 4:5.16.3-285.el7 perl-Carp.noarch 0:1.26-244.el7 perl-Encode.x86_64 0:2.51-7.el7 perl-Error.noarch 1:0.17020-2.el7 perl-Exporter.noarch 0:5.68-3.el7  perl-File-Path.noarch 0:2.09-2.el7 perl-File-Temp.noarch 0:0.23.01-3.el7 perl-Filter.x86_64 0:1.49-3.el7 perl-Getopt-Long.noarch 0:2.40-2.el7 perl-Git.noarch 0:1.8.3.1-4.el7 perl-HTTP-Tiny.noarch 0:0.033-3.el7 perl-PathTools.x86_64 0:3.40-5.el7 perl-Pod-Escapes.noarch 1:1.04-285.el7 perl-Pod-Perldoc.noarch 0:3.20-4.el7  perl-Pod-Simple.noarch 1:3.28-4.el7  perl-Pod-Usage.noarch 0:1.63-3.el7 perl-Scalar-List-Utils.x86_64 0:1.27-248.el7 perl-Socket.x86_64 0:2.010-3.el7 perl-Storable.x86_64 0:2.45-3.el7 perl-TermReadKey.x86_64 0:2.30-20.el7 perl-Text-ParseWords.noarch 0:3.29-4.el7 perl-Time-HiRes.x86_64 4:1.9725-3.el7 perl-Time-Local.noarch 0:1.2300-2.el7 perl-constant.noarch 0:1.27-2.el7 perl-libs.x86_64 4:5.16.3-285.el7 perl-macros.x86_64 4:5.16.3-285.el7 perl-parent.noarch 1:0.225-244.el7 perl-podlators.noarch 0:2.5.1-3.el7 perl-threads.x86_64 0:1.87-4.el7 perl-threads-shared.x86_64 0:1.43-6.el7  rsync.x86_64 0:3.0.9-15.el7

CMD ["/usr/local/bin/bundle", "exec", "middleman"]
